\documentclass[amsmath,superscriptaddress,showpacs,aps,prb,twocolumn]{revtex4-1}
\usepackage[colorlinks,linkcolor=blue,anchorcolor=blue,citecolor=blue,urlcolor=blue]{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{bm}

\begin{document}
\title{Ferromagnetism and spin excitations in topological Hubbard models with a flat-band}
\author{Xiao-Fei Su}
\affiliation{National Laboratory of Solid State Microstructures and Department of Physics, Nanjing University, Nanjing 210093, China}
\affiliation{School of Physics and Electronic Information, Huaibei Normal University, Huaibei 235000, China}
\author{Zhao-Long Gu}
\affiliation{National Laboratory of Solid State Microstructures and Department of Physics, Nanjing University, Nanjing 210093, China}
\author{Zhao-Yang Dong}
\affiliation{National Laboratory of Solid State Microstructures and Department of Physics, Nanjing University, Nanjing 210093, China}
\author{Shun-Li Yu}
\affiliation{National Laboratory of Solid State Microstructures and Department of Physics, Nanjing University, Nanjing 210093, China}
\affiliation{Collaborative Innovation Center of Advanced Microstructures, Nanjing University, Nanjing 210093, China}
\author{Jian-Xin Li}
\email[]{jxli@nju.edu.cn}
\affiliation{National Laboratory of Solid State Microstructures and Department of Physics, Nanjing University, Nanjing 210093, China}
\affiliation{Collaborative Innovation Center of Advanced Microstructures, Nanjing University, Nanjing 210093, China}
\date{\today}

\begin{abstract}
\par We study the spin-1 excitation spectra of the flatband ferromagnetic phases in topological Hubbard models. As a paradigm, we consider a quarter filled square lattice Hubbard model whose free part is the $\pi$ flux model with topologically nontrivial and nearly-flat electron bands. The model Hamiltonian either explicitly breaks the time-reversal symmetry but preserves the spin $SU(2)$ rotation symmetry (Chern Hubbard model), or preserves the time-reversal symmetry but explicitly breaks the spin $SU(2)$ rotation symmetry ($Z_2$ Hubbard model). By using the numerical exact diagonalization method with a projection onto the lower nearly-flat electron band, we determine the critical Hubbard interaction upon which the ferromagnetic phase is stable, and obtain the ferromagnetic spin-1 excitation spectra of the Chern Hubbard model and the $Z_2$ Hubbard model. Both spectra consist of collective modes (spin waves) and individual modes (Stoner continuum). For the Chern Hubbard model, the spin wave is gapless while for the $Z_2$ Hubbard model, the spin wave is gapped. Remarkably, in both cases, the nonflatness of the free electron bands introduces dips of the lower boundary of the Stoner continuum, and significantly renormalizes the energies of the collective modes around these dips downward, which can lead to roton-like spin wave excitations. We elaborate that the destabilization of the ferromagnetic phase happens when the energy of the induced roton-like modes becomes zero with the increase of the nonflatness.
\end{abstract}
\maketitle

\section{Introduction}
\par Electronic bands with nonzero topological indices reside on the center of a substantial amount of topological phenomena in condensed matter physics \cite{HK_RMP2010,QZ_RMP2011}. It was proposed in a pioneering work by Haldane \cite{H_PRL1988} that a spinless fermionic model on a honeycomb lattice exhibits integer quantum Hall effect \cite{KDP_PRL1980} without an external magnetic field. This model, serving as the first example of Chern insulator, breaks the time reversal symmetry with a complex next-nearest-neighbor hopping and is characterized by a nonzero Chern number \cite{TKNN_PRL1982}. Later, the concept was generalized to time reversal symmetric systems with spin-orbital coupling (SOC), such as the monolayer graphene \cite{KM_PRL2005a,KM_PRL2005b} and HgTe/CdTe quantum wells \cite{BHZ_S2006,Ketc_S2007}. The SOC there generates complex hopping terms similar to that proposed by Haldane but with opposite chiralities for electrons with up spins and down spins, resulting in the quantum spin Hall insulator characterized by a $Z_2$ index.

\par The lattice models with nontrivial band topology share much similarity with the two-dimensional electron gas (2DEG) under a strong magnetic field with Landau levels, e.g. the existence of topologically protected gapless edge states \cite{H_PRL1988,L_PRB1981,H_PRB1982,KM_PRL2005a,KM_PRL2005b,BHZ_S2006,Ketc_S2007,YXL_PRL2011,LYGL_PRB2016,LGLW_NJP2017}. Thus more novel phases other than the Chern insulator or $Z_2$ insulator are expected when Coulomb interactions are taken into account, as is similar to the fractional quantum Hall effect \cite{TSG_PRL1982,L_PRL1983} in the 2DEG with Landau levels. However, different from Landau levels, energy bands in lattice models usually have noneligible dispersions, which weakens the effect of Coulomb interactions. Therefore, in recent years, much effort has been devoted to the design and search of tight-binding models that host nearly-flat electron bands with nontrivial topology \cite{TMW_PRL2011,WR_PRB2011,SGKD_PRL2011,WGGS_PRL2011,NSCM_PRL2011,TB_PRB2012,YGSD_PRB2012}. Analogous exotic phases, such as the fractional Chern insulator and fractional topological insulator were numerically verified to emerge in such nearly-flat topological bands when strong Coulomb interactions are turned on \cite{NSCM_PRL2011,SGSS_NC2011,RB_PRX2011,NSRCM_PRB2011,LBFL_PRL2012}.

\par Another involved intriguing phenomenon arising from Coulomb repulsions in flat or nearly-flat bands is the itinerant ferromagnetism \cite{T_PTP1998}. It was proved by Tasaki and Mielke that the ground state of an flat electron band with its filling factor not more than but sufficiently close to $1/2$ is ferromagnetically ordered as long as an infinitesimal onsite Hubbard repulsion is present \cite{T_PRL1992,M_PLA1993,MT_CMP1993}. Afterwards this ferromagnetism was shown to be stable against small nonflatness of the electron bands if and only if the Hubbard interaction exceeds a critical value \cite{T_PRL1994}. Spin wave excitations over this ferromagnetic ground state was also studied \cite{KA_PRL1994,SGDL_PRB2018} and itinerant topological magnons has been reported quite recently \cite{SGDL_PRB2018}.

\par The interplay between flatband ferromagnetism and nontrivial band topology enriches the related physics. In fact, ferromagnetism is essential in the generation of stable fractional Chern insulators in the proposals where the spin degrees of freedom of electrons are considered \cite{TMW_PRL2011,NSRCM_PRB2011,LBFL_PRL2012}. Furthermore, ferromagnetism can also lead to possible high-temperature quantum anomalous Hall effect (QAHE) when the nearly-flat topological band is half-filled \cite{NSRCM_PRL2012}. In this paper, we focus on this ferromagnetism induced QAHE in nearly-flat topological bands. As a paradigm, we consider a square lattice Hubbard model whose free part is the $\pi$ flux model with topologically nontrivial and nearly-flat electron bands. The model Hamiltonian either explicitly breaks the time-reversal symmetry but preserves the spin $SU(2)$ rotation symmetry (Chern Hubbard model), or preserves the time-reversal symmetry but explicitly breaks the spin $SU(2)$ rotation symmetry ($Z_2$ Hubbard model). When the model is quarter filled (or correspondingly, the lower nearly-flat band is half filled), the ground state is spin fully polarized due to the ferromagnetism and exhibits QAHE because of the nonzero Chern number of a single-spin band. Then the low energy physics is dominated by the one-spin-flip excitations. These spin-1 excitations have been studied by a generalized bosonization scheme where the interacting fermionic model is mapped to a free bosonic model describing spin-wave excitations at the harmonic approximation \cite{DG_PRB2015}. The ferromagnetism was shown to be stable against such spin wave excitations, which are gapless in the Chern Hubbard model and gapped in the $Z_2$ Hubbard model. However in this bosonization scheme, the free part of the electron model plays no role in the spin wave excitations other than contributing a global constant, which means it should fail due to the competition between the kinetic energy and potential energy of electrons when the nonflatness of the electron bands is not negligible \cite{T_PRL1994}. In fact, in a strictly local periodic tight-binding model, an energy band with a nonzero Chern number cannot be exactly flat \cite{CMST_JPMT2014}. Therefore it remains an open question on whether the ground state is stable against the spin-1 excitations and how the nonflatness of the electron bands manifests itself in the spin-1 excitation spectra in such models.

\par To elucidate these questions, we adopt the numerical exact diagonalization method with a projection onto the lower nearly-flat band to take close investigations on the spin-1 excitations of the models. A critical magnitude of the Hubbard interaction is found for both the Chern Hubbard model and the $Z_2$ Hubbard model, upon which the ferromagnetic phase is stable. Furthermore, the spin-1 excitation spectra are shown to consist of collective modes (spin waves) and individual modes (Stoner continuum). For the Chern Hubbard model, the spin wave is gapless while for the $Z_2$ Hubbard model, the spin wave is gapped. Remarkably, for both cases, the nonflatness of the free electron bands introduces dips of the lower boundary of the Stoner continuum, and significantly renormalizes the energies of the collective modes around these dips downward, which leads to roton-like spin wave excitations. With the increase of this nonflatness, the energy of the induced roton-like modes goes down and finally touches zero, which results in the destabilization of the ferromagnetic phase. We also make a comparison of our results in the flatband limit with those obtained by the bosonization scheme \cite{DG_PRB2015}. Qualitative agreements are observed for the Chern Hubbard model, yet notable discrepancy appears for the $Z_2$ Hubbard model. We attribute the discrepancy to the self-interactions of the magnons, which is ignored in the bosonization scheme but treated exactly in our method after the projection.

\par The rest of the paper is organized as follows. In Sec. \ref{mm}, we introduce the Chern Hubbard model and $Z_2$ Hubbard model studied in this paper, discuss the nontrivial band topology of their free parts, interpret the emergence of QAHE resulting from the interplay of flat-band ferromagnetism and nontrivial band topology, and formulate the exact diagonalization method with a projection onto the lower nearly-flat band on details. In Sec. \ref{nr}, we summarize the phase diagram and elaborate the spin-1 excitation spectra of both models. Section \ref{sd} provides a summary and discussion.

\section{Model and method}\label{mm}
\subsection{Introduction to model}\label{intro_to_model}

\begin{figure}
\includegraphics[width=\columnwidth]{lattice}
\caption{(Color online) (a) Schematic representation of the $\pi$-flux model. Blue and red solid circles denote the $A$ and $B$ sublattices, respectively. The nearest-neighbor hopping amplitudes (solid black lines) are equal to $t_{1}\exp[i\alpha(\sigma)\pi/4]$ ($\alpha(\sigma)=1$ for the time-reversal-symmetry-breaking case and $\alpha(\sigma)=\pm1$ for the time-reversal-symmetry-preserving case) along the direction of the arrows, the next-nearest-neighbor hopping amplitudes are equal to $t_{2}$ (dashed green lines) and $-t_{2}$ (dashed purple lines). The shaded area denotes the unit cell. (b) First Brillouin Zone. $\Gamma=(0,0)$, $X_{1,2}=(\pm\pi,0)$, $Y_{1,2}=(0,\pm\pi)$, $M_{1,2,3,4}=(\pm\pi,\pm\pi)$.}
\label{lattice}
\end{figure}

\par We consider a generalized $\pi$-flux Hubbard model on the square lattice, whose Hamiltonian can be written as $H=H_0+H_U$, where $H_0$ is the generalization with electron spin of the original spinless model proposed in Ref. \cite{NSCM_PRL2011},
\begin{equation}
H_0=\sum_{\langle ij\rangle,\sigma}(t_1^{ij,\sigma}c_{i\sigma}^\dagger c_{j\sigma}+\text{H.c.})
    +\sum_{\langle\langle ij\rangle\rangle,\sigma}(t_2^{ij}c_{i\sigma}^\dagger c_{j\sigma}+\text{H.c.}),
\end{equation}
and $H_U$ is the Hubbard interaction
\begin{equation}
H_U=U\sum_{i}n_{i\uparrow}n_{i\downarrow}.
\end{equation}
Here, $c_{i\sigma}^{\dagger}(c_{i\sigma})$ creates (annihilates) a spin $\sigma$ electron at site $i$, $n_{i\sigma}$ is the spin $\sigma$ electron number operator at site $i$, $\langle ij\rangle$ denotes the nearest-neighbor (NN) bonds and $\langle\langle ij\rangle\rangle$ denotes the next-nearest-neighbor (NNN) bonds. As is shown in Fig. \ref{lattice}(a), the spin-dependent NN hopping amplitude $t_1^{ij,\sigma}$ and the spin-independent NNN hopping amplitude $t_2^{ij}$ are given by
\begin{equation}
t_1^{ij,\sigma}=t_1\exp\left[i\delta^1_{ij}\alpha_\sigma\pi/4\right],
\end{equation}
\begin{equation}
t_2^{ij}=t_2\delta^2_{ij}.
\end{equation}
Here, $\delta^1_{ij}=+1$ if the NN electron hopping is along the direction of the solid black arrow and $\delta^1_{ij}=-1$ if along the reversed direction. $\delta^2_{ij}=+1$ if the NNN electron hopping is along the dashed green lines and $\delta^2_{ij}=-1$ if along the dashed purple lines. The spin-dependent phase $\alpha_\sigma$ breaks the time-reversal symmetry but preserves the spin $SU(2)$ rotation symmetry if $\alpha_\uparrow=\alpha_\downarrow=+1$, whereas it preserves the time-reversal symmetry but breaks the spin $SU(2)$ rotation symmetry if $\alpha_\uparrow=+1$ and $\alpha_\downarrow=-1$.

\par Due to the complex NN hopping, each electron will acquire a $\pi$ phase as it hops around a plaquette along the direction of the black arrows as indicated in Fig. \ref{lattice}(a). Therefore, $H_0$ describes free electrons hopping on a square lattice in the presence of a fictitious staggered $\pi$-flux pattern \cite{WWZ_PRB1989}. For the time-reversal-symmetry-breaking case, $\alpha_\uparrow=\alpha_\downarrow$, the flux experienced by spin-up electrons and spin-down electrons is the same, while for the time-reversal-symmetry-preserving case, $\alpha_\uparrow=-\alpha_\downarrow$, it is opposite.

\subsection{Topology of free part}\label{topo_free_part}
\par Gapped noninteracting fermionic systems can be topologically classified in the presence of symmetries by their Hamiltonians in the momentum space\cite{SRFL_PRB2008}. After the Fourier transformation, the free part $H_0$ of our model reads
\begin{equation}
H_0=\sum_{\mathbf{k}\sigma}\psi^{\dagger}_{\mathbf{k}\sigma}h_{\mathbf{k}\sigma}\psi_{\mathbf{k}\sigma},
\end{equation}
where $\psi^{\dagger}_{\mathbf{k}\sigma}=(c^{\dagger}_{A\mathbf{k}\sigma},c^{\dagger}_{B\mathbf{k}\sigma})$ and
\begin{equation}
h_{\mathbf{k}\sigma}={\mathbf{D}_{\mathbf{k}\sigma}}\cdot\bm{\tau}.
\end{equation}
Here $\bm{\tau}=(\tau_{1},\tau_{2},\tau_{3})$ is a $2\times2$ matrix vector, $\tau_{1},\tau_{2},\tau_{3}$ are the three Pauli matrices for the sublattice degrees of freedom. The components of $\mathbf{D}_{\mathbf{k}\sigma}$ are given by
\begin{equation}
\begin{aligned}
&D_{1,\mathbf{k}}=2\sqrt{2}t_{1}\cos\frac{k_{x}}{2}\cos\frac{k_{y}}{2},\\
&D_{2,\mathbf{k}}=2\sqrt{2}t_{1}\alpha_\sigma\sin\frac{k_{x}}{2}\sin\frac{k_{y}}{2},\\
&D_{3,\mathbf{k}}=2t_{2}(\cos k_{x}-\cos k_{y}).
\end{aligned}
\end{equation}
$H_0$ can be diagonalized with the transformation
\begin{equation}
\begin{aligned}
&c_{A\mathbf{k}\sigma}=\mu_{1,\mathbf{k}\sigma}d_{\mathbf{k}\sigma}+\mu_{2,\mathbf{k}\sigma}f_{\mathbf{k}\sigma},\\
&c_{B\mathbf{k}\sigma}=\mu^{\ast}_{1,\mathbf{k}\sigma}f_{\mathbf{k}\sigma}-\mu^{\ast}_{2,\mathbf{k}\sigma}d_{\mathbf{k}\sigma},\\
\end{aligned}
\end{equation}
where
\begin{equation}
\begin{aligned}
&\mu_{1,\mathbf{k}\sigma}=\frac{D_{1,\mathbf{k}}-i\alpha_\sigma D_{2,\mathbf{k}}}{\sqrt{2D_{\mathbf{k}}(D_{\mathbf{k}}+D_{3,\mathbf{k}})}},\\
&\mu_{2,\mathbf{k}\sigma}=\frac{D_{\mathbf{k}}+D_{3,\mathbf{k}}}{\sqrt{2D_{\mathbf{k}}(D_{\mathbf{k}}+D_{3,\mathbf{k}})}},\\
\end{aligned}
\end{equation}
with $D_{\mathbf{k}}=\sqrt{D^2_{1,\mathbf{k}}+D^2_{2,\mathbf{k}}+D^2_{3,\mathbf{k}}}$. The diagonalized $H_0$ is given by
\begin{equation}
H_{0}=\sum_{\mathbf{k}\sigma}\varepsilon_{d}(\mathbf{k})c^{\dagger}_{\mathbf{k}\sigma}c_{\mathbf{k}\sigma}
      +\sum_{\mathbf{k}\sigma}\varepsilon_{f}(\mathbf{k})f^{\dagger}_{\mathbf{k}\sigma}f_{\mathbf{k}\sigma},
\end{equation}
where $\varepsilon_{d}(\mathbf{k})=-D_{\mathbf{k}}$, $\varepsilon_{f}(\mathbf{k})=D_{\mathbf{k}}$. It can be seen that there exists a gap between the $d$ band and $f$ band when $t_1\ne0$ and $t_2\ne0$.
\par When there is a gap between the $d$ band and the $f$ band, these bands can be shown to be topologically non-trivial by calculating their Chern numbers \cite{TKNN_PRL1982} (for the time-reversal-symmetry-breaking case) or $Z_2$ indices \cite{KM_PRL2005b,SWSH_PRL2006} (for the time-reversal-symmetry-preserving case). The Chern number for a single spin component of the $d$ band or the $f$ band can be expressed in terms of the coefficients $D_{i,\mathbf{k}}$ \cite{HK_RMP2010,QZ_RMP2011},
\begin{equation}
C_{\sigma}^{d/f}=\pm\frac{1}{4\pi}\int_{BZ}d^{2}k\;
    \hat{\mathbf{D}}_{\mathbf{k}\sigma}\cdot(\partial_{k_{x}}\hat{\mathbf{D}}_{\mathbf{k}\sigma}\times\partial_{k_{y}}\hat{\mathbf{D}}_{\mathbf{k}\sigma})
    =\pm\alpha_\sigma,
\end{equation}
with $\hat{\mathbf{D}}_{\mathbf{k}\sigma}\equiv\mathbf{D}_{\mathbf{k}\sigma}/D_{\mathbf{k}}$.
\par When the system breaks the time-reversal symmetry, i.e. $\alpha_\uparrow=\alpha_\downarrow=1$, $C_\uparrow^d=C_\downarrow^d=1$ and $C_\uparrow^f=C_\downarrow^f=-1$, the total Chern number of the $d$ band is $C^d=C_\uparrow^d+C_\downarrow^d=2$. Therefore, the ground state of $H_0$ will be a noninteracting Chern insulator and exhibits quantum anomalous Hall effect(QAHE) when the lower $d$ band is fully filled. When the system preserves the time-reversal symmetry, i.e. $\alpha_\uparrow=-\alpha_\downarrow=1$, $C_\uparrow^d=-C_\downarrow^d=1$ and $C_\uparrow^f=-C_\downarrow^f=-1$, the total Chern number of the $d$ band is zero. However, the $Z_2$ index, which is defined as
\begin{equation}
\nu=\frac{1}{2}(C_{\uparrow}-C{\downarrow})\mod2,
\end{equation}
of the $d$ band is $1$ and nontrivial. As a consequence, the the ground state of $H_0$ will be a noninteracting $Z_2$ insulator and exhibits quantum spin Hall effect(QSHE) when the lower $d$ band is fully filled.

\subsection{Emergence of QAHE in half-filled nearly-flat topological bands}\label{emerg_qahe}
\par For a free fermionic system hosting an energy band with a nonzero Chern number or $Z_2$ index, the distinguished phenomenon resulting from this nontrivial band topology, such as QAHE or QSHE, only manifests itself when the topological band is fully filled. At any fractional filling, the ground state of such a system will be a trivial metal. Intriguingly, when the Coulomb interactions between electrons step in, the physics of the nontrivial band topology becomes more involved, especially when the band is nearly flat so that the effects of the Coulomb interactions are highly enhanced. Combined with strong Coulomb interactions, nontrivial topological phases can emerge from fractionally filled topological bands. In this article, we are interested in half-filled strongly-correlated nearly-flat topological bands where QAHE can arise\cite{NSCM_PRL2011,DG_PRB2015}. The essence for the occurrence of this nontrivial phase is the emergence of itinerant ferromagnetism on nearly-flat bands\cite{T_PTP1998}, which fully polarizes all the electron spins. Therefore only one spin component of the topological band will be fully filled exactly, which leads to QAHE due to the nonzero Chern number of that spin component of the band.

\par The Chern Hubbard model and $Z_2$ Hubbard model on square lattice described above serve as the paradigm, where half filling of the lower electron band corresponds to quarter filling of the whole system because of the existence of $AB$ sublattices. When $t_2/t_1$ takes values in a selected region, the $d$ band and $f$ band are quite flat in that the flatness ratio $\Delta/W$, which is defined as the ratio between the electron gap $\Delta$ between these two bands and the bandwidth $W$ of the lower band, can be as large as $4.83$ \cite{NSCM_PRL2011,DG_PRB2015}. In Ref. \cite{NSCM_PRL2011}, the quarter filled $Z_2$ Hubbard model was studied and all spin excitations were shown to be gapped in the flatband limit, which is essential for a possible high-temperature realization of QAHE. In Ref. \cite{DG_PRB2015}, both models at quarter filling were considered and a generalized bosonization scheme was developed to study the spin-1 excitation spectra. However, in their bosonization scheme, the free part $H_0$ of the Hamiltonian only contributes a constant to the spectra, thus it cannot capture the physics caused by the nonflatness of the topological electron bands, which is unavoidable because an energy band with a nonzero Chern number in a strictly local periodic tight binding model cannot be exactly flat \cite{CMST_JPMT2014}. The spin-1 excitations, as the dominant low-energy excitations, deserves closer investigations to understand the stability of such phases and the physics related to the nonflatness of the topological bands. In the next subsection, we will introduce the exact diagonalization method with a projection onto the lower nearly-flat electron band to elucidate these questions.

\subsection{Exact diagonalization with projection}\label{exact_diag_proj}
\par Exact diagonalization method with a projection onto the low-energy Hilbert space bas been widely applied to systems that host flat or nearly-flat energy bands \cite{NSCM_PRL2011,RB_PRX2011,NSRCM_PRB2011,SGDL_PRB2018,NSRCM_PRL2012,DG_PRB2015}. This approach ignores the band mixing of electrons and applies when the Coulomb interaction is small compared to the energy gap of the electron bands.

\par For the model we study in this article, the relevant low-energy subspace is the lower electron band, i.e. the $d$ band. Let $P$ denote the corresponding projector, then the Hamiltonian after the projection is
\begin{widetext}
\begin{equation}
P^\dagger HP=\sum_{\mathbf{k}\sigma}\varepsilon_d(\mathbf{k})d^{\dagger}_{\mathbf{k}\sigma}d_{\mathbf{k}\sigma}
+\frac{U}{N}\sum_{a=1,2}\sum_{\mathbf{k}\mathbf{k}^{\prime}\mathbf{q}}
(\mu^{\ast}_{a,\mathbf{k}+\mathbf{q}\uparrow}\mu^{\ast}_{a,\mathbf{k}^{\prime}-\mathbf{q}\downarrow}\mu_{a,\mathbf{k}^{\prime}\downarrow}\mu_{a,\mathbf{k}\uparrow})
d^{\dagger}_{\mathbf{k}+\mathbf{q}\uparrow}d^{\dagger}_{\mathbf{k}^{\prime}-\mathbf{q}\downarrow}d_{\mathbf{k}^{\prime}\downarrow}d_{\mathbf{k}\uparrow}.
\end{equation}
\end{widetext}
Let $|\text{FM}\rangle$ denote the spin-up fully polarized state on the $d$ band,
\begin{equation}
|\text{FM}\rangle=\prod_{\mathbf{k}\in \text{FBZ}}d^{\dagger}_{\mathbf{k}\uparrow}|\text{0}\rangle,
\end{equation}
where FBZ denotes the first Brillouin zone [see Fig. \ref{lattice}(b)] and $|0\rangle$ is the fermion vaccum. Then the basis of the spin-1 excitations with a center-of-mass momentum $\mathbf{q}$ over this reference state can be written as
\begin{equation}
|\mathbf{k}_i\rangle_\mathbf{q}=d^{\dagger}_{\mathbf{k}_{i}-\mathbf{q}\downarrow}d_{\mathbf{k}_{i}\uparrow}|\text{FM}\rangle.
\end{equation}
Here $d^{\dagger}_{\mathbf{k}_{i}-\mathbf{q}\downarrow}$ creates a spin-down electron with momentum $\mathbf{k}_{i}-\mathbf{q}$ and $d_{\mathbf{k}_{i}\uparrow}$ annihilates a spin-up electron with momentum $\mathbf{k}_{i}$. Therefore this basis labels a spin-1 scattering channel with the index $\mathbf{k}_{i}$. Thus the dimension of this Hilbert space scales linearly with respect to the number of electron momentums \cite{SGDL_PRB2018}, and a much larger system can be numerically accessed than the usual exact diagonalization without projection, which enables us to analyze the properties of the spin-1 excitation spectra at the whole first Brillouin zone rather than some restricted discrete points solely. The matrix element of the projected Hamiltonian on this spin-1 excitation basis can be easily obtained after some algebra,
\begin{widetext}
\begin{equation}\label{PHP}
\begin{aligned}
_\mathbf{q}\langle\mathbf{k}_j|P^\dagger HP|\mathbf{k}_i\rangle_\mathbf{q}&=\left[\varepsilon_d(\mathbf{k}_i-\mathbf{q})-\varepsilon_d(\mathbf{k}_i)
+\frac{U}{N}\sum_{a=1,2}\sum_{\mathbf{p}\neq\mathbf{k}_i}\left|\mu_{a,\mathbf{p}\uparrow}\right|^2\left|\mu_{a,\mathbf{k}_{i}-\mathbf{q}\downarrow}\right|^2
\right]\delta_{\mathbf{k}_j,\mathbf{k}_i} \\
& -\frac{U}{N}\sum_{a=1,2}
\mu^{\ast}_{a,\mathbf{k}_{i}\uparrow}\mu_{a,\mathbf{k}_{j}\uparrow}\mu^{\ast}_{a,\mathbf{k}_j-\mathbf{q}\downarrow}\mu_{a,\mathbf{k}_i-\mathbf{q}\downarrow}
\left(1-\delta_{\mathbf{k}_j,\mathbf{k}_i}\right).
\end{aligned}
\end{equation}
\end{widetext}
Here $\delta_{\mathbf{k}_j,\mathbf{k}_i}$ is the Kronecker delta function. Then the full spin-1 excitation spectra can be obtained by the diagonalization of the matrix whose elements are defined by Eq. (\ref{PHP}). It is noted that $|\text{FM}\rangle$ is the true ground state only if the whole spin-1 excitation spectra have no negative eigen energies. Thus we can use this as the criterion to determine the destabilization point of the ferromagnetic phase.
\par We also want to give some remarks on the flatband limit in the framework of this method. The free part $h^\text{flat}_{\mathbf{k}\sigma}$ of the Hamiltonian in the flatband limit is defined as
\begin{equation}
h^{\text{flat}}_{\mathbf{k}\sigma}=\frac{h_{\mathbf{k}\sigma}}{\left|\varepsilon_{d}(\mathbf{k})\right|}={\hat{\mathbf{D}}_{\mathbf{k}\sigma}}\cdot\mathbf{\tau}.
\end{equation}
$h^\text{flat}_{\mathbf{k}\sigma}$ shares the same eigenfunctions with $h_{\mathbf{k}\sigma}$ but has exactly-flat energy bands with the eigenvalues being $\pm 1$. $h^\text{flat}_{\mathbf{k}\sigma}$, together with the Hubbard interaction $H_U$, defines the flatband limit of the original Hamiltonian. To approach this limit, long-range hopping terms in the real space must be included \cite{NSCM_PRL2011}. To reveal the physics related to the nonflatness of the $d$ band, we also calculated the spin-1 excitation spectra in the flatband limit for comparison. This can be done by simply ignoring the $\left[\varepsilon_d(\mathbf{k}_i-\mathbf{q})-\varepsilon_d(\mathbf{k}_i)\right]\delta_{\mathbf{k}_j,\mathbf{k}_i}$ term in Eq. (\ref{PHP}), because of the same eigenfunctions shared by $h^\text{flat}_{\mathbf{k}\sigma}$ and $h_{\mathbf{k}\sigma}$.

\section{Numerical results}\label{nr}
\begin{figure}
\includegraphics[width=\columnwidth]{phase}
\caption{(Color online) Phase diagrams of the quarter-filled (a) Chern Hubbard model and (b) $Z_2$ Hubbard model. The colormap represents the ratio $U/W$ of the lower electron band, where $U$ is the Hubbard interaction strength and $W$ is the lower electron bandwidth. Red stars in (a) and (b) mark the parameters used in Fig. \ref{fmcispectrum} and Fig. \ref{tispectrum}(a), respectively. Blue stars in (a) and (b) mark the parameters used in Fig. \ref{pbcispectrum}. and Fig. \ref{tispectrum}(b), respectively.}
\label{phase}
\end{figure}

\par Before the detailed discussion on the spin-1 excitation spectra of the quarter-filled Chern Hubbard model and $Z_2$ Hubbard model, we present their phase diagrams first, which are shown in Fig. \ref{phase}. Here, the colormap represents the ratio of the Hubbard interaction strength $U$ over the lower electron bandwidth $W$. FM denotes the ferromagnetic phase and NFM denotes the non-ferromagnetic phase. As is discussed in Sec. \ref{exact_diag_proj}, the phase boundary is determined as the onset point of $U$ below which negative spin-1 excitation spectra arise. The phase diagrams of these two models appear quite similar. It is obvious that a critical Hubbard interaction strength is needed to maintain the ferromagnetically ordered ground state when the electron band has finite nonflatness. Furthermore the phase boundaries always lie near the contour line with $U/W=2.0$. Qualitatively speaking, these observations are expected as a result from the competition between the kinetic energy and the potential energy of the electrons, as a fully spin-polarized state minimizes the energy of Hubbard interactions but cost more energy when the electron band disperses. In the following, we will elaborate the spin-1 excitation spectra of these models to investigate the physics observed above microscopically and quantitatively.

\subsection{Chern Hubbard model}\label{CHM}
\begin{figure}
\includegraphics[width=\columnwidth]{fmcispectrum}
\caption{(Color online) (a) Spin-1 excitation spectra of the Chern Hubbard model in the FM phase. Green solid lines denote the spin waves and the grey region denotes the Stoner continuum. Green dashed lines represent the corresponding spectra in the flatband limit. Blue solid lines denote the upper and lower boundaries of the Stoner continuum determined by the band-splitting picture shown in (c). Black arrows mark the local minima of the Stoner continuum. (b) Spectral weights for the lowest four eigen levels of the spin-1 excitation spectra with the center-of-mass momentum $\mathbf{q}=(0,0)$. (c) Illustration of the splitting of the lower electron bands for up spins (blue solid line) and down spins (blue dashed line) in the presence of ferromagnetism of the Chern Hubbard model. Inset shows the positions of the corresponding local maxima (red solid circles) of the spin-up bands and local minima (purple solid circles) of the spin-down bands in the first Brillouin zone. Green arrows denote the corresponding scattering channels of the valley bottoms of the Stoner continuum marked in (a). (d) Differences of the spectral weights subtracted by those in the flatband limit for the lowest four eigen levels of the spin-1 excitation spectra with the center-of-mass momentum $\mathbf{q}=(\pi,0)$. The parameters are $t_1=1.0$, $t_2=0.49$ and $U=2.3$.}
\label{fmcispectrum}
\end{figure}

\par In this subsection, we focus on the quarter-filled Chern Hubbard model. Its spin-1 excitation spectra in the FM phase along a high symmetry path in the first Brillouin zone are plotted in Fig. \ref{fmcispectrum}(a) as two low-lying green solid lines and a high-energy shaded area, with the parameters marked by the red star in Fig. \ref{phase}(a). The modes in the green solid lines and the shaded area take on distinct behaviors: the former exhibits well-defined band structures while the latter forms a continuum. In fact, for these two kinds of modes, the patterns of the contributions from each spin-1 particle-hole scattering channel of electrons, which are embodied in the eigenvectors $\Psi_{\mathbf{q}}(\mathbf{k}_i)$ of Eq. \ref{PHP}, are quite different. In Fig. \ref{fmcispectrum}(b), the spectral weights of each scattering channel, i.e. $|\Psi_{\mathbf{q}}(\mathbf{k}_i)|^2$ as a function of $\mathbf{k}_i$, for the four lowest eigen levels with the center-of-mass momentum $\mathbf{q}=(0,0)$ ($\Gamma$ point) are shown. It is clear that for the modes in the green solid lines [Fig. \ref{fmcispectrum}($\text{b}_1$) and Fig. \ref{fmcispectrum}($\text{b}_2$)], the spectral weights come from a quite broad range of scattering channels; indeed, the spectral weight for the lowest eigen mode at $\Gamma$ point is even homogeneous for all scattering channels. However, for those in the shaded area [Fig. \ref{fmcispectrum}($\text{b}_3$) and Fig. \ref{fmcispectrum}($\text{b}_4$)], the spectral weights almost come from a single scattering channel. Therefore, the former modes are collective spin-1 excitations and are identified as the spin waves while the latter modes are individual spin-1 excitations and are identified as the Stoner continuum. Due to the $AB$ sublattice of the model, the spin waves contains an acoustic branch and an optical branch. The acoustic branch is gapless, which is consistent with the Goldstone theorem as the spin-fully polarized ground state spontaneously breaks the spin $SU(2)$ rotation symmetry.

\par To explore the physics related to the nonflatness of the lower electron band, the corresponding spin-1 excitation spectra in the flatband limit are also shown in Fig. \ref{fmcispectrum}(a) as the green dashed lines. The flatband-limit spectra consist of two parts as well, i.e. the low-lying spin waves and the high-energy Stoner continuum. However, in this case, the Stoner continuum is just a pile of featureless flat lines at $U/2$. Comparing the spectra of the original model with this, as indicated by the black arrows in Fig. \ref{fmcispectrum}(a), we can conclude that the nonflatness of the electron band introduces dips of the lower boundary of the Stoner continuum. Furthermore, around these dips, the energies of the collective modes are apparently renormalized downward, leading to the occurrence of roton-like local minima on the optical branch.

\par The above physics can be illustrated by a simple band-splitting picture as shown in Fig. \ref{fmcispectrum}(c). Roughly speaking, in the presence of ferromagnetism, the spin-down electron band and spin-up electron band are split in energy proportional to $U\langle m \rangle$, where $U$ is the Hubbard interaction strength and $\langle m \rangle$ is the average magnetic moment per site. For a quarter-filled electron model with two inequivalent sublattices, $\langle m \rangle=1/2$. Thus the energy splitting is $U/2$. Then an individual spin-1 excitation, or a mode in the Stoner continuum, can be viewed as the excitation of an electron from the lower fully-filled spin-up band to the upper empty spin-down band. This argument can be verified by our numerical results. In fact, the sharp locality on the $\mathbf{k}_i$ space of the spectral weights of a mode in the Stoner continuum [as has be seen in Fig. \ref{fmcispectrum}($\text{b}_3$) and Fig. \ref{fmcispectrum}($\text{b}_4)$] implies that this kind of mode is mainly determined by the corresponding diagonal term in Eq. \ref{PHP}. By numerics, we also find that the term $\frac{U}{N} \sum_{a=1,2} \sum_{\mathbf{p}\neq\mathbf{k}_i} \left| \mu_{a,\mathbf{p}\uparrow} \right|^2 \left| \mu_{a,\mathbf{k}_{i}-\mathbf{q}\downarrow} \right|^2 \sim \frac{U}{2}$. Therefore, the excitation energies of the Stoner continuum can be approximated by $\varepsilon_{d\downarrow} (\mathbf{k}_i-\mathbf{q}) + \frac{U}{2} -\varepsilon_{d\uparrow} (\mathbf{k}_i)$, which is consistent with the above picture. In Fig. \ref{fmcispectrum}(a), the lower and upper boundaries of the Stoner continuum approximated by this argument are plotted as the blue solid lines, which fits extremely well with the true boundaries of the shaded area, thus verifies the validity of this simple argument. Now we can find out the dominant scattering channels that contribute most to the valley bottoms of the Stoner continuum and read off their center-of-mass momentums easily. In the inset of Fig. \ref{fmcispectrum}(c), we mark the local maxima of the spin-up band with red solid circles and the local minima of the spin-down band with purple ones. The scattering channels corresponding to the valley bottoms marked by the black arrows in Fig. \ref{fmcispectrum}(a) are also indicated by green arrows. Obviously, a spin-1 excitation of an electron from one of the spin-up maxima to one of the spin-down minima appears as a valley bottom of the lower boundary of the Stoner continuum and the momentum difference of these two electron state provides the center-of-mass momentum of that spin-1 excitation.

\par Within this picture, the collective modes of the spectra can be viewed as bound states in the gap of the Stoner continuum. Then the physics of the downward renormalization of the energies of the collective modes induced by the valley bottoms of the Stoner continuum is quite similar to that observed in the two-dimensional antiferromagents, where the suppression of the energies of the spin waves are explained by their couplings to the nearby deconfined spinon continuum \cite{ZFSMC_PRL2006,TS_PRL2013,DMCNTPEMIR_NP2015,YWDYL_arXiv2018}. To understand the renormalization of the collective modes observed here, in Fig. \ref{fmcispectrum}(d), we plot the spectral weights of the four lowest eigen levels subtracted by those in the flatband limit with the center-of-mass momentum $q=(\pi,0)$ ($X_1$ point). The differences concentrate around the scattering channels labeled by $\mathbf{k}_i=(\pm\pi,0)$ and $\mathbf{k}_i=(0,\pm\pi)$. However, the results for the collective modes [Fig. \ref{fmcispectrum}($\text{d}_1$) and Fig. \ref{fmcispectrum}($\text{d}_2$)] are positive while those for the individual modes at the valley bottom of the Stoner continuum [Fig. \ref{fmcispectrum}($\text{d}_3$) and Fig. \ref{fmcispectrum}($\text{d}_4$)] are negative. Therefore a noticeable amount of spectral weights transfer from the latter to the former, which indicates a strong coupling between the spin waves and the nearby Stoner continuum. This coupling renormalizes the energies of the spin waves and leads to the occurrence of a roton-like local minimum for the optical branch.

\begin{figure}
\includegraphics[width=\columnwidth]{pbcispectrum}
\caption{(Color online) (a) Spin-1 excitation spectra of the Chern Hubbard model at the FM/NFM phase boundary. Black arrow marks the minimum of the Stoner continuum. Inset shows its low-energy part along $\Gamma$-$X$ path with an amplified resolution. (b) Illustration of the splitting of the lower electron bands of the Chern Hubbard model. Inset shows the positions of the corresponding local maxima (red solid circles) of the spin-up bands and local minima (purple solid circles) of the spin-down bands in the first Brillouin zone. Green arrows denote the corresponding scattering channels of the minimum of the Stoner continuum marked in (a). The parameters are $t_1=1.0$, $t_2=0.43$ and $U=2.3$.}
\label{pbcispectrum}
\end{figure}

\par The physics discussed above is essential for the destabilization of the ferromagnetic phase. In Fig. \ref{pbcispectrum}(a), we plot the spin-1 excitation spectra of the model at the FM/NFM phase boundary, with the parameters marked by the blue star in Fig. \ref{phase}(a). The corresponding illustration of the split-band picture is shown in Fig. \ref{pbcispectrum}(b). It can be seen that with this increased nonflatness, the valley bottom marked by the black arrow in Fig. \ref{pbcispectrum}(a) of the Stoner continuum goes deeper toward zero energy. Besides the roton-like local minimum on the optical band, a roton-like local minimum on the acoustic band also appears, which can be seen more clearly in the inset of Fig. \ref{pbcispectrum}(a). With the further increase of the nonflatness of the electron band, the energy of this newly formed roton mode will go down through the zero energy, which leads to the final destabilization of the ground state. From Fig. \ref{fmcispectrum}(c) and Fig. \ref{pbcispectrum}(b), we can see that the ferromagnetic ground state is quite robust against the spin-1 flips until the top of the spin-up band is approaching near to the bottom of the spin-down band. Considering that the energy splitting of these two bands is $U/2$, the destabilization point would be quite close to $U/2\sim W$.

\subsection{$Z_2$ Hubbard model}\label{ZHM}
\begin{figure}
\includegraphics[width=\columnwidth]{tispectrum}
\caption{(Color online) (a) and (b): Spin-1 excitation spectra of the $Z_2$ Hubbard model. Green solid lines denote the spin waves and the grey regions denote the Stoner continuum. Green dashed lines represent the corresponding spectra in the flatband limit. Black arrows mark the minima of the Stoner continuum. (c) and (d): Illustration of the splitting of the lower electron bands of the $Z_2$ Hubbard model. Insets show the positions of the corresponding local maxima (red solid circles) of the spin-up bands and local minima (purple solid circles) of the spin-down bands in the first Brillouin zone. Green arrows denote the corresponding scattering channels of the minima of the Stoner continuum marked in (a) and (b). $t_2=0.65$ for (a) and (c) and $t_2=0.741$ for (b) and (d). Other parameters are fixed at $t_1=1.0$, $U=2.3$.}
\label{tispectrum}
\end{figure}

\par In this subsection, we focus on the quarter-filled $Z_2$ Hubbard model. Its spin-1 excitation spectra along a high symmetry path in the first Brillouin zone with the parameters marked by the red star and blue star in Fig. \ref{phase}(b) are plotted in Fig. \ref{tispectrum}(a) and Fig. \ref{tispectrum}(b), respectively. As is similar to Sec. \ref{CHM}, the low-lying green solid lines represent the spin waves (collective modes) and the high-energy shaded areas represent the Stoner continuum (individual modes). A distinction from the Chern Hubbard model is that the collective modes here are gapped because the $Z_2$ Hubbard model explicitly breaks the spin $SU(2)$ rotation symmetry and no spontaneous continuous symmetry breaking occurs in the ferromagnetic phase. The corresponding spectra in the flatband limit are shown as the green dashed lines in Fig. \ref{tispectrum}(a) and Fig. \ref{tispectrum}(b) as well for comparison. Similarly, the nonflatness of the electron band introduces dips of the Stoner continuum, and the energies of the spin waves around the valley bottoms of the Stoner continuum are renormalized downward, which results in roton-like modes on both branches of the spin waves. The dominant scattering channels leading to the dips of the Stoner continuum and the renormalization of the spin waves can also be determined by the previously proposed band-splitting picture, which is illustrated in Fig. \ref{tispectrum}(c) and Fig. \ref{tispectrum}(d). Their insets shows the corresponding local maxima (red solid circles) of the spin-up bands and local minima (purple solid circles) of the spin-down bands in the first Brillouin zone. Here only the scattering channels that contribute to the valley bottoms marked by the black arrows in Fig. \ref{tispectrum}(a) and Fig. \ref{tispectrum}(b) are stressed because their induced roton-like modes lead to the destabilization of the ferromagnetic ground state [See Fig. \ref{tispectrum}(b)]. We want to remark that although the center-of-mass momentums of the forementioned valley bottoms are the same, the scattering channels are different because the bottom of the spin-down band changes from the $\Gamma$ and $M_{1,2,3,4}$ points to the $X_{1,2}$ and $Y_{1,2}$ points when $t_2$ changes from $0.65$ to $0.741$ [See Fig. \ref{tispectrum}(c) and Fig. \ref{tispectrum}(d)]. Last but not least, the ferromagnetic ground state is also quite robust against the spin flips until the bottom of the spin-down band almost overlaps with the top of the spin-up band on energy, which means the phase boundary of the FM/NFM is also quite close to $U/W=2$.

\section{Summary and discussion}\label{sd}
\par In summary, we have considered the flatband ferromagnetic phases in a quarter-filled Chern Hubbard model and a quarter-filled $Z_2$ Hubbard model in this paper. By using the numerical exact diagonalization method with a projection onto the lower nearly-flat electron band, we determine the critical Hubbard interaction strength upon which the ferromagnetic phase is stable, and elaborate the ferromagnetic spin-1 excitation spectra of these models. Both spectra consist of collective modes (spin waves) and individual modes (Stoner continuum). For the Chern Hubbard model, the spin wave is gapless while for the $Z_2$ Hubbard model, the spin wave is gapped. Remarkably, for both cases, the nonflatness of the free electron bands introduces dips of the lower boundary of the Stoner continuum, and significantly renormalizes the energies of the collective modes around these dips downward, which can lead to roton-like spin wave excitations. With the increase of this nonflatness, the energy of the induced roton-like modes goes down and finally touches zero, which results in the destabilization of the ferromagnetic phase.

\par We want to make a comparison of our flatband-limit results with those obtained by the generalized bosonization formalism proposed in Ref. \cite{DG_PRB2015}, where both the nonflatness of the electron bands and the self-interactions between the magnons are ignored. For the Chern Hubbard model, our results are qualitatively consistent with theirs [See Fig. \ref{fmcispectrum}(a) in our paper and Fig. 4 in Ref. \cite{DG_PRB2015}]. However, for the $Z_2$ Hubbard model, our results are different from theirs at two points at least [See Figs. \ref{tispectrum}(a)-(b) in our paper and Fig. 5 in Ref. \cite{DG_PRB2015}]. On the one hand, the band bottom of the spin waves in our results lies at the $M_{1,2,3,4}$ points while theirs lies at the $\Gamma$ point . On the other hand, the acoustic branch and optical branch are degenerate along the $\Gamma$-$X$ path in our results while they are degenerate along the $X$-$M$ path in theirs. We attribute this discrepancy to the self-interactions of the magnons because our numerical method treat the system after the projection exactly. Although correlated nearly-flat topological bands are hard to realize in real materials, they are possible to be designed in cold-atom systems. In fact great progress has been made very recently \cite{LCJPS_N2009,AALBPB_PRL2013,MSKBK_PRL2013,JMDLUGE_N2014}. We thus expect our results to be tested in future cold-atom experiments.

\begin{acknowledgments}
\par This work was supported by the National Natural Science Foundation of China (11774152) and National Key Projects for Research and Development of China (Grant No. 2016YFA0300401).
\par X.-F. S. and Z.-L. G. contributed equally to this work.
\end{acknowledgments}

\bibliography{ref}
\end{document}
